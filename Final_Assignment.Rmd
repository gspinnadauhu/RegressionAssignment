---
title: "Regression Models Course Project - Cars & MPG"
author: "gspinnadauhu"
date: "April 14, 2017"
output: pdf_document
---

##### Executive Summary

##### Data
This analysis is using the 'mtcars' dataset native to R.
Loading and examining the structure of the data:
```{r}
data("mtcars")
head(mtcars)
str(mtcars)
summary(mtcars)
```
This dataset has 32 observations and 11 variables.

There are no missing observations.
```{r}
sum(is.na(mtcars))
```
##### Questions
###### 1.“Is an automatic or manual transmission better for MPG”
First, plotting MPG by transmission (am: 0=auto, 1=manual)
```{r}
library(ggplot2)
ggplot(data=mtcars,aes(y=mpg,x=factor(am)))+
        geom_boxplot()+
        theme_classic()+
        labs(title="MPG by Transmission type",
             x="Transmission Type",
             y="Miles per Gallon")
```
It appears that manual transmission gets better mileage average overall, as the median falls above the upper quartile range of data for automatic transmission mpg.

Next, exploring the relationship between mpg (dependent variable) and am, using a simple linear model.
Let us first look at correllations between mpg and the other variables.
```{r}
cor(mtcars)[,1]
```
It appears here that mpg is highly correllated with #cylinders, engine displacement, horsepower, weight and to a lesser extent rear axle ratio.
These variables will be included, in addition to am, in the regression. Note that am (transmission) is not that highly correllated with mpg.

To avoid having too much multicollinearity, we now look at a correllation matrix between the chosen variables. Visualizing the correllations magnitudes in a correllation plot.
```{r}
library(corrplot)
corrplot(cor(mtcars[,-c(7,8,10,11)]),type="upper",tl.col="black",tl.srt=45)
```
Based on the above graphic, cyl, wt and disp are highly correllated between the other variables. This could lead to some multicollinearity when running the regression. We will make the determination if some of these should be excluded based on variance inflation factors.
It may also be useful to utilize interaction variables, i.e. hp/wt, which is a commonly used statistic for cars, usually called the "power to weight ratio".

The set of variables to be included in the linear model are the following:
y  mpg: miles per gallon (continuous)
x1 cyl: number of cylinders (discrete)
x2 disp: engine displacement (continuous)
x3 hp: horsepower (continuous)
x4 drat: real axle ratio (continuous)
x5 wt: weight in 1000lbs (continuous)
x6 am: Transmission type (0=automatic, 1=manual) (discrete)

```{r}
mpg_linear<-lm(mpg~factor(cyl)+disp+hp+drat+wt+factor(am),mtcars)
summary(mpg_linear)
```
There seem to be some problems with this model, the adj R-sq suggests this model explains ~83% of variability, yet only hp's and wt's coefficients are significant at p<0.05.
The signs of the hp and wt coefficients are correct and suggest that, holding all else equal, for each 1hp increase, mpg drops by 0.03miles and for each 1000lb increase in weight, mpg drops by -2.72miles. So, i.e. a 10-ton vehicle, holding all else equal, would on average get 32.6-2.73*(10)=5.3miles per gallon.

Next, using variance inflation factors to see how addition of variables is inflating variance.
```{r}
library(car)
vif(mpg_linear)
```
Weight has a somewhat elevated inflation factor, but displacement and cyl have very high factors as expected, as large engine displacement almost always comes from higher numbers of cylinders in passenger cars. wt is also fairly high as larger displacement engines also tend to weigh more, contributing to overall vehicle weight.

Next, looking at a residual plot.
```{r}
plot(predict(mpg_linear),resid(mpg_linear))
```
There appears to be no distinguishable pattern

###### 2."Quantify the MPG difference between automatic and manual transmissions"

##### Conclusion